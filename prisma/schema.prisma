generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Manufacturer {
  id            Int             @id @default(autoincrement())
  name          String
  logo          String?
  categories    String[]
  rating        Float
  deliveryTime  String
  products      myProduct[]
  orders        Order[]


  middleMenRelation middleMenRelation[]
}

model myProduct {
  id            Int     @id @default(autoincrement())
  manufacturerId Int
  manufacturer  Manufacturer @relation(fields: [manufacturerId], references: [id])
  name          String
  skuId         Int 
  category      String
  price         Float
  minOrder      Int @default(1) 
  inStock       Boolean @default(false)
  batches batches[]

  orderItem orderItem[]

  inventory inventory[]
}

model batches {
  id            Int     @id @default(autoincrement())
  skuId     Int
  batchNumber   String
  manufactureDate DateTime @db.Date
  expiryDate    DateTime @db.Date
  quantity      Int
  product       myProduct @relation(fields: [skuId], references: [id])



  InventoryBatch InventoryBatch[]
}

model Order {
  id             String   @id @default(uuid())
  manufacturerId Int
  manufacturer   Manufacturer @relation(fields: [manufacturerId], references: [id])
  date           DateTime @db.Date
  total          Float @default(0)
  status         orderStatus @default(PENDING)

  orderItem orderItem[] 
  middleMenRelation middleMenRelation? @relation(fields: [middleMenRelationid], references: [id])
  middleMenRelationid Int?

  shopkeeper shopkeeper? @relation(fields: [shopkeeperId], references: [id])
  shopkeeperId Int?
}



model orderItem {
  id             Int     @id @default(autoincrement())
  orderId        String
  order          Order   @relation(fields: [orderId], references: [id])
  productId      Int
  product        myProduct @relation(fields: [productId], references: [id])
  quantity       Int
  price          Float
  totalPrice     Float @default(0)
}

model middleMen{
    id            Int     @id @default(autoincrement())
    name          String
    logo          String?
    categories    String[]
    rating        Float
    deliveryTime  String



    middleMenRelation middleMenRelation[]
}

